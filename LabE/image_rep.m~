function image_rep( im, m )
n= m-5;

figure;colormap('gray');imagesc(im);

N = 8;
A = im2col(im,[N N],'distinct');
size(A)

C = A*A';        
[e l] = eig(C);               
[PM p] = sort(diag(l),'descend'); 
PC = e(:,p);                      

[PC S] = svd(A);                  
PM = diag(S);  

figure(11);
subplot(2,1,1);plot(PM,'o');
subplot(2,1,2);plot(log(PM),'o');

figure(12);colormap('gray');
for M=n:m,
    c=PC(:,1:M)'*A;    %Compute coordinates from blocks
    Arec=PC(:,1:M)*c;  %Reconstruct blocks from coordinates
    imrec=col2im(Arec,[N N],size(im),'distinct');  %Reshape into image
    subplot(2,3,M);imagesc(imrec);axis('off');     %Display image
    title(sprintf('%d principal components',M));   %Set title
end


end

